[Workflow]
Id:,viaje_workflow
Title:,Workflow para viajes
Description:,Permite establecer un flujo para la confirmacion y aprobacion de viajes.
Initial state:,borrador

[State]
Id:,borrador
Title:,Borrador
Description:,Una vez completado, el encargado lo aprobara para solicitud.
Transitions,guardar_borrador
Permissions,			Acquire, Anonymous, Authenticated, Member, Manager, Owner, Editor, Reader, Contributor,	Reviewer
View,				N,	 N,	    N,	 	   N, 	   N,	    Y,	   N,	   N,	   N,		N
Access contents information,	N,	 N,	    N,	 	   N,	   N,	    Y,	   N,	   N,	   N,		N
Modify portal content,		N,	 N,	    N,	 	   N,	   N,	    Y,	   N,	   N,	   N,		N
Delete objects,    		N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   N,	   N,		N  

[State]
Id:,revision_aprobador
Title:,Revision aprobador
Description:,Pendiente de revision.
Transitions:,"aprobar_solicitud,fallo_borrador"
Permissions,			Acquire, Anonymous, Authenticated, Member, Manager, Reader,Editor, Owner,  Contributor,	Reviewer
View,				N,	 N,	    N,	 	   N, 	   Y,	    Y,	   N,	   Y,	   Y,		N
Access contents information,	N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   N,	   N,		N
Modify portal content,		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N
Review portal content,		N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   N,	   N,		N
Delete objects,    		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N  

[State]
Id:,esperando_agencia
Title:,Esperando agencia
Description:,Esperando registro de informacion de agencia.
Transitions:,"enviar_anticipo,fallo_tramite"
Permissions,			Acquire, Anonymous, Authenticated, Member, Manager, Owner, Editor, Reader, Contributor,	Reviewer, Implant
View,				N,	 N,	    N,	 	   N, 	   Y,	    Y,	   N,	   Y,	   Y,		N,	  Y,
Access contents information,	N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   Y,	   Y,		N,	  Y,
Modify portal content,		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N,	  N,
Review portal content,		N,	 N,	    N,	 	   N,	   Y,	    N,	   N,	   N,	   N,		N,	  Y,
Delete objects,    		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N, 	  N,

[State]
Id:,anticipo_pendiente
Title:,Anticipo pendiente
Description:,Anticipo por autorizar.
Transitions:,"registrar,fallo_anticipo"
Permissions,			Acquire, Anonymous, Authenticated, Member, Manager, Owner, Editor, Reader, Contributor,	Reviewer, Finanzas, Implant
View,				N,	 N,	    N,	 	   N, 	   Y,	    Y,	   N,	   Y,	   Y,		N, 	  Y,	    Y,
Access contents information,	N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   Y,	   Y,		N,	  Y,	    Y,
Modify portal content,		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N,	  N,	    N,
Review portal content,		N,	 N,	    N,	 	   N,	   Y,	    N,	   N,	   N,	   N,		N,	  Y,	    N,
Delete objects,    		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N,	  N, 	    N,

[State]
Id:,final
Title:,Registrado
Description:,Solicitud registrada.
Transitions:,
Permissions,			Acquire, Anonymous, Authenticated, Member, Manager, Owner, Editor, Reader, Contributor,	Reviewer, Implant
View,				N,	 N,	    N,	 	   N, 	   Y,	    Y,	   N,	   Y,	   Y,		N, 	  Y,
Access contents information,	N,	 N,	    N,	 	   N,	   Y,	    Y,	   N,	   Y,	   Y,		N,	  Y,	  
Modify portal content,		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N,	  N,	  
Review portal content,		N,	 N,	    N,	 	   N,	   N,	    N,	   N,	   N,	   N,		N,	  N,


[Transition]
Id:,guardar_borrador
Title:,Guardar borrador
Description:,Confirmar informacion del viaje. 
Target state:,revision_aprobador
Guard expression:, here/@@can-send-to-agency
Guard permission:,Request review
Script after:,viaticos.viajes.Extensions.mailer.boss_mail

[Transition]
Id:,aprobar_solicitud
Title:,Aprobar solicitud
Description:,Automatico
Target state:,esperando_agencia
Guard expression:, here/@@can-send-to-agency
Guard permission:,Review portal content

[Transition]
Id:,enviar_anticipo
Title:,Enviar anticipo
Description:,Autorizar montos de anticipo
Target state:,anticipo_pendiente
Guard expression:, here/@@can-send-to-agency
Guard permission:,Review portal content
Script after:,viaticos.viajes.Extensions.mailer.finances_mail

[Transition]
Id:,registrar
Title:,Registrar
Description:,Registrar solicitud de gastos
Target state:,final
Guard expression:, here/@@can-send-to-agency
Guard permission:,Review portal content
Script before:,viaticos.viajes.Extensions.triggers.create_comprobacion

[Transition]
Id:,fallo_borrador
Title:,No aprobado
Description:,De vuelta al creador para correccion
Target state:,borrador
Guard expression:, here/@@can-send-to-agency
Guard permission:,"Request review, Review portal content"
Script after:,viaticos.viajes.Extensions.mailer.return_to_draft


[Transition]
Id:,fallo_tramite
Title:,Modificar solicitud
Description:,"Rechazado. Por corregir."
Target state:,borrador
Guard permission:,Review portal content
Script after:,viaticos.viajes.Extensions.mailer.rejected


[Transition]
Id:,fallo_anticipo
Title:,Anticipo no aprobado
Description:,"Anticipo no autorizado, por revisar montos."
Target state:,esperando_agencia
Guard permission:,Review portal content
Script after:,viaticos.viajes.Extensions.mailer.finances_rejected

